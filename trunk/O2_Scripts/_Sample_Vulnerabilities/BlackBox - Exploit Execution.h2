<?xml version="1.0"?>
<H2>
  <SourceCode>//panel.clear();
//var topPanel = panel.add_Panel();  
var topPanel = O2Gui.open&lt;Panel&gt;("Exploit Execution", 800,600);
var mainGui = topPanel.add_1x1("Exploits (BlackBox PoCs)", "Browser",true, 350);
var wpfHost = mainGui[0].add_WpfHost();
var browser = mainGui[1].add_IE();


// methods

Action&lt;string,string&gt; loadExploitScript =
	(exploitFile, startUrl)=&gt;{
							try
							{
								wpfHost.clear();
								var grid = wpfHost.add_Control_Wpf&lt;WPF.Grid&gt;();  
								var sp = grid.add_StackPanel();   
								if (exploitFile.fileExists().isFalse())
								{ 
									exploitFile = exploitFile.local();
									if (exploitFile.fileExists().isFalse())	
									{
										"could not find exploit script to load:{0}".error(exploitFile);
										return;
									}
								}	  
								var compiledExploitFile = exploitFile.compile();
								if (compiledExploitFile.notNull())  
								{  
									var classWithExploits = compiledExploitFile.types()[0].ctor(browser, startUrl); 
									//classWithExploits.prop("StartUrl", startUrl); 
									//classWithExploits.prop("Browser", browser); 										  
									foreach(var method in classWithExploits.type().methods_public())
									{	 		
										var methodToInvoke = method;
										var buttonText = method.Name.replace("_"," ");  
										//sp.add_Xaml_Button(buttonText, ()=&gt; PublicDI.reflection.invokeMethod_Instance(classWithExploits, methodToInvoke.Name, new object[] {})); 
										sp.add_Xaml_Button(buttonText, 
											()=&gt; O2Thread.mtaThread(
												()=&gt; Reflection_ExtensionMethods.invoke(classWithExploits,methodToInvoke.Name)));
									}
								}
							}
							catch(Exception ex)
							{
								ex.log("in loadExploitScript");
							}

						};

//var exploitFile = "HacmeBank_BlackBox_Exploits.cs".local();
	
var userDataPanel = topPanel.insert_Above&lt;Panel&gt;(25);
userDataPanel.add_Label("Script file with exploits")
				.top(5)
			 .append_TextBox("")
				.width(300)
			 .append_Label("Url of start page")
				.top(5)
				.leftAdd(15) 
			 .append_TextBox("")
				.width(300)
			 .append_Link("Load exploits",
			 	()=&gt;{
			 			var textBoxes = userDataPanel.controls&lt;TextBox&gt;(true);
			 			loadExploitScript(textBoxes[0].get_Text(),textBoxes[1].get_Text());
			 		})
			 	.top(5)
			  .append_Link("Edit exploit code", 
			  	()=&gt;{
			  			var scriptFile = userDataPanel.controls&lt;TextBox&gt;(true)[0].get_Text();
			  			mainGui[1].insert_Below&lt;Panel&gt;().add_SourceCodeEditor().open(scriptFile.local());  
			  		});
			 
			 
userDataPanel.controls&lt;TextBox&gt;(true)[0].set_Text("HacmeBank_BlackBox_Exploits.cs");
userDataPanel.controls&lt;TextBox&gt;(true)[1].set_Text("http://localhost:54579/HacmeBank_v2_Website");
userDataPanel.controls&lt;LinkLabel&gt;(true)[0].click(); 

//browser.open("http://www.google.co.uk");
//sp.add_Xaml_Button("Login as JM", ()=&gt;{}); 


//using WatiN.Core
//using O2.XRules.Database.APIs

//O2File:Ref:WatiN_IE_ExtensionMethods.cs    
//O2Ref:Interop.SHDocVw.dll
//O2Ref:WatiN.Core.1x.dll
//O2File:DotNet_ViewState.cs
//O2Ref:Microsoft.mshtml.dll

//O2File:XamlCode.cs
//O2File:XamlCode_ExtensionMethods.cs


//using O2.XRules.Database.APIs
//using O2.API.Visualization.ExtensionMethods

//using WPF = System.Windows.Controls
//O2Ref:O2_API_AST.dll

//O2Ref:O2_API_Visualization.dll
//O2Ref:PresentationCore.dll
//O2Ref:PresentationFramework.dll
//O2Ref:WindowsBase.dll   
//O2Ref:System.Core.dll
//O2Ref:WindowsFormsIntegration.dll
//O2Ref:GraphSharp.dll
//O2Ref:QuickGraph.dll 
//O2Ref:GraphSharp.Controls.dll
//O2Ref:ICSharpCode.AvalonEdit.dll</SourceCode>
  <ReferencedAssemblies />
</H2>