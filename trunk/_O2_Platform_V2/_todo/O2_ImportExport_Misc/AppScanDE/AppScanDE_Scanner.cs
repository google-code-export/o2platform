// This file is part of the OWASP O2 Platform (http://www.owasp.org/index.php/OWASP_O2_Platform) and is released under the Apache 2.0 License (http://www.apache.org/licenses/LICENSE-2.0)
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;
using O2.DotNetWrappers.Windows;

namespace O2.ImportExport.Misc.AppScanDE
{
    public class AppScanDE_Scanner
    {
        const string appScanDECommandLineParams1 = @"-classpath F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.client.examples_7.8.1.v200904022218\bin.examples;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.client.examples_7.8.1.v200904022218\bin.ant;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.client.examples_7.8.1.v200904022218\bin;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.client_7.8.1.v200904022218.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.common_7.8.1.v200904022218.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.emf.common_2.2.1.v200705141058.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.core.runtime_3.2.0.v20060603.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.osgi_3.2.3.R32x_v20071108.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.equinox.common_3.2.0.v20060603.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.core.jobs_3.2.0.v20060603.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.core.runtime.compatibility.registry_3.2.1.R32x_v20060907\runtime_registry_compatibility.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.equinox.registry_3.2.1.R32x_v20060814.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.equinox.preferences_3.2.2.R32x_v20080117.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.core.contenttype_3.2.0.v20060603.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant.jar;";
        const string appScanDECommandLineParams2 = @"F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-antlr.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-apache-bcel.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-apache-bsf.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-apache-log4j.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-apache-oro.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-apache-regexp.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-apache-resolver.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-commons-logging.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-commons-net.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-icontract.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-jai.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-javamail.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-jdepend.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-jmf.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-jsch.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-junit.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-launcher.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-netrexx.jar;";
        const string appScanDECommandLineParams3 = @"F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-nodeps.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-starteam.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-stylebook.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-swing.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-trax.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-vaj.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-weblogic.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-xalan1.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.ant_1.6.5\lib\ant-xslp.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.ant.core_3.1.100.v20060531.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.icu_3.4.5.20061213.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\codeanalysisCore.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\castor-1.0.5.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\commons-el.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\commons-logging-api.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\jasper-compiler-jdt.jar;";
        const string appScanDECommandLineParams4 = @"F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\jasper-compiler.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\jasper-runtime.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\jsp-api.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\naming-factory-dbcp.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\naming-factory.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\naming-resources.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.codeanalysis.core_7.8.1.v200904022218\jar\jasper\servlet-api.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.wala.taint_1.1.4.v200904022218\taintLibrary.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.wala.appscan.core_1.1.4.v200904022218.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.wala.appscan.shrike_1.1.4.v200904022218.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.core.resources_3.2.2.R32x_v20061218.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.jdt.core_3.2.8.v_691_R32x.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.ui_3.2.1.M20061108.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.swt_3.2.3.v3236c.jar;";
        const string appScanDECommandLineParams5 = @"F:\AppScan\IBM\SDPShared\plugins\org.eclipse.swt.win32.win32.x86_3.2.3.v3236c.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rcp.swt.browser.dom.ie_6.1.0.0-20080228-FP4\ws\win32\iedom.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.jface_3.2.2.M20061214-1200.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.core.commands_3.2.0.I20060605-1400.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.ui.workbench_3.2.2.M20070119-0800.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.engine_7.8.1.v200904022218\engineBridge.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.rational.appscan.instrumentation_7.8.1.v200904022218.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.wala.automaton_1.1.4.v200904022218.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.wala.appscan.j2ee_1.1.4.v200904022218.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.jem_1.2.1.v20060918_M.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.jst.j2ee.core_1.1.55.v2008051900.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.wala.stringAnalysis_1.1.3.v200904022218.jar;F:\AppScan\IBM\SDPShared\plugins\com.ibm.wala.stringAnalysis.java_1.1.4.v200904022218.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.commons_logging_1.0.4.v200608011657\lib\commons-logging-1.0.4.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.jakarta_log4j_1.2.8.v200607172048\lib\log4j-1.2.8.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.xerces_2.8.0.v200606131651\resolver.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.xerces_2.8.0.v200606131651\xercesImpl.jar;F:\AppScan\IBM\SDPShared\plugins\org.apache.xerces_2.8.0.v200606131651\xml-apis.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.compare_3.2.1.M20060711.jar;F:\AppScan\IBM\SDPShared\plugins\org.eclipse.text_3.2.0.v20060605-1400.jar";
        const string appScanDECommandLineParams6 = @" com.ibm.rational.appscan.client.examples.analysis.O2AppScanDE_BasedOn_SimpleScenario1";

        public Process executeAppScanDEScan(string targetFolder,string tempAppScanWorkingDirectory, DataReceivedEventHandler onAppScanLogEvent)
        {
            var executable = "java.exe";
            var executableParams = appScanDECommandLineParams1 + appScanDECommandLineParams2 +
                                   appScanDECommandLineParams3 + appScanDECommandLineParams4 +
                                   appScanDECommandLineParams5 + appScanDECommandLineParams6 + " \"" + targetFolder + "\" \"" + tempAppScanWorkingDirectory + "\"";
            return Processes.startProcessAsConsoleApplication(executable, executableParams, onAppScanLogEvent);
        }
    }
}
